class Calculator{constructor(previousOperandtextElement,currentOperandtextElement){this.previousOperandtextElement=previousOperandtextElement,this.currentOperandtextElement=currentOperandtextElement,this.clear(),this.storedConstants=new StoredConstants,this.loadStoredConstants()}clear(){this.currentOperand="",this.previousOperand="",this.operation=void 0}delete(){this.currentOperand=this.currentOperand.toString().slice(0,-1)}appendNumber(number){"."===number&&this.currentOperand.includes(".")||(this.currentOperand=this.currentOperand.toString()+number.toString())}chooseOperation(operation){""!==this.currentOperand&&(""!==this.previousOperand&&this.compute(),this.operation=operation,this.previousOperand=this.currentOperand,this.currentOperand="")}compute(){let computation;const prev=parseFloat(this.previousOperand),current=parseFloat(this.currentOperand);if(!isNaN(prev)&&!isNaN(current)){switch(this.operation){case"+":computation=prev+current;break;case"-":computation=prev-current;break;case"x":computation=prev*current;break;case"÷":computation=prev/current;break;default:return}this.currentOperand=computation,this.operation=void 0,this.previousOperand=""}}getDisplayNumber(number){const stringNumber=number.toString(),integerDigits=parseFloat(stringNumber.split(".")[0]),decimalDigits=stringNumber.split(".")[1];let integerDisplay;return integerDisplay=isNaN(integerDigits)?"":integerDigits.toLocaleString("en",{maximumFractionDigits:0}),null!=decimalDigits?`${integerDisplay}.${decimalDigits}`:integerDisplay}updateDisplay(){this.currentOperandtextElement.innerText=this.getDisplayNumber(this.currentOperand),null!=this.operation?this.previousOperandtextElement.innerText=`${this.getDisplayNumber(this.previousOperand)} ${this.operation}`:this.previousOperandtextElement.innerText=""}loadStoredConstants(){this.storedConstants.load();let options=this.storedConstants.constants,select=document.getElementById("select-constant");select.innerHTML="";for(let key in options){let el=document.createElement("option");el.textContent=key,el.value=options[key],select.appendChild(el)}}}const numberButtons=document.querySelectorAll("[data-number]"),operationButtons=document.querySelectorAll("[data-operation]"),equalsButton=document.querySelector("[data-equals]"),deleteButton=document.querySelector("[data-delete]"),loadConstantButton=document.querySelector("[data-load-constant]"),saveConstantButton=document.querySelector("[data-save-constant]"),deleteConstantButton=document.querySelector("[data-delete-constant]"),allClearButton=document.querySelector("[data-all-clear]"),previousOperandtextElement=document.querySelector("[data-previous-operand]"),currentOperandtextElement=document.querySelector("[data-current-operand]"),calculator=new Calculator(previousOperandtextElement,currentOperandtextElement);numberButtons.forEach(button=>{button.addEventListener("click",()=>{calculator.appendNumber(button.innerText),calculator.updateDisplay()})}),operationButtons.forEach(button=>{button.addEventListener("click",()=>{calculator.chooseOperation(button.innerText),calculator.updateDisplay()})}),equalsButton.addEventListener("click",button=>{calculator.compute(),calculator.updateDisplay()}),allClearButton.addEventListener("click",button=>{calculator.clear(),calculator.updateDisplay()}),deleteButton.addEventListener("click",button=>{calculator.delete(),calculator.updateDisplay()}),loadConstantButton.addEventListener("click",button=>{let select=document.getElementById("select-constant"),name=select.options[select.selectedIndex].text,val=calculator.storedConstants.value(name);calculator.currentOperand=val,calculator.updateDisplay()}),saveConstantButton.addEventListener("click",button=>{let value=calculator.currentOperand;if(""==value)return void alert("Sie müssen einen Wert für die Variable in den Rechner eingeben");let name=prompt("Geben Sie den Namen der Konstanten ein","");null!=name&&""!=name&&(calculator.storedConstants.add(name,value),calculator.storedConstants.save(),calculator.loadStoredConstants(),alert("Die Konstante wurde gespeichert"))}),deleteConstantButton.addEventListener("click",button=>{if(confirm("Wollen Sie die Konstante wirklich löschen?")){let select=document.getElementById("select-constant"),name=select.options[select.selectedIndex].text;calculator.storedConstants.remove(name),calculator.loadStoredConstants()}});